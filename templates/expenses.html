<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>Xarajatlar</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <style>
        .container {
            max-width: 900px;
            margin: 40px auto;
        }

        .card {
            background: white;
            padding: 20px;
            border-radius: 14px;
            box-shadow: 0 10px 25px rgba(0,0,0,.08);
            margin-bottom: 24px;
        }

        .error {
            background:#fee2e2;
            color:#b91c1c;
            padding:12px;
            border-radius:10px;
            margin-bottom:15px;
            font-weight:600;
        }

        .balance-box {
            background: linear-gradient(135deg,#06b6d4,#3b82f6);
            color:white;
            padding:20px;
            border-radius:14px;
            font-size:18px;
        }

        .balance-box strong {
            font-size:30px;
            display:block;
            margin-top:5px;
        }

        .expense-form {
            display:flex;
            gap:12px;
            flex-wrap:wrap;
        }

        .expense-form input {
            flex:1;
            padding:10px;
            border-radius:8px;
            border:1px solid #ddd;
        }

        .expense-form button {
            background:#4f46e5;
            color:white;
            border:none;
            padding:10px 18px;
            border-radius:8px;
            cursor:pointer;
        }

        .filter-bar {
            display:flex;
            gap:12px;
            align-items:center;
            flex-wrap:wrap;
        }

        .filter-bar input {
            padding:8px;
            border-radius:8px;
            border:1px solid #ddd;
        }

        .filter-bar button {
            background:#2563eb;
            color:white;
            border:none;
            padding:8px 14px;
            border-radius:8px;
            cursor:pointer;
        }

        .filter-bar a {
            text-decoration:none;
            color:#2563eb;
            font-weight:500;
        }

        .expenses-list {
            list-style:none;
            padding:0;
            margin:0;
        }

        .expenses-list li {
            display:flex;
            justify-content:space-between;
            align-items:center;
            padding:14px;
            border-bottom:1px solid #eee;
        }

        .expenses-list li:last-child {
            border-bottom:none;
        }

        .amount {
            font-weight:700;
        }

        .date {
            color:#6b7280;
            font-size:13px;
        }
    </style>
</head>
<body>

{% include "navbar.html" %}

<div class="container">

    <h2>üí∏ Xarajatlar</h2>

    {% if error %}
        <div class="error">{{ error }}</div>
    {% endif %}

    <!-- BALANCE -->
    <div class="card balance-box">
        Joriy balans
        <strong>{{ balance }} so‚Äòm</strong>
    </div>

    <!-- ADD EXPENSE -->
    <div class="card">
        <h3>‚ûï Xarajat qo‚Äòshish</h3>

        {% if balance > 0 %}
        <form method="POST" class="expense-form">
            <input type="number" name="amount" placeholder="Summa" required min="1">
            <input type="text" name="description" placeholder="Izoh" required>
            <button type="submit">Qo‚Äòshish</button>
        </form>
        {% else %}
            <p style="color:#b91c1c;font-weight:600;">
                ‚ùå Balans 0. Xarajat qo‚Äòsha olmaysiz.
            </p>
        {% endif %}
    </div>

    <!-- FILTER -->
    <div class="card">
        <h3>üîç Filter</h3>

        <form method="GET" class="filter-bar">
            <label>üìÖ Kun</label>
            <input type="date" name="day" value="{{ request.args.get('day','') }}">

            <label>üìÜ Oy</label>
            <input type="month" name="month" value="{{ request.args.get('month','') }}">

            <button type="submit">Filter</button>
            <a href="{{ url_for('expenses') }}">‚ôªÔ∏è Tozalash</a>
        </form>
    </div>

    <!-- EXPENSES -->
    <div class="card">
        <h3>üìÑ Mening xarajatlarim</h3>

        {% if expenses %}
            <ul class="expenses-list">
                {% for e in expenses %}
                <li>
                    <div>
                        <div class="amount">{{ e[0] }} so‚Äòm</div>
                        <div>{{ e[1] }}</div>
                    </div>
                    <div class="date">{{ e[2] }}</div>
                </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>Hozircha xarajat yo‚Äòq</p>
        {% endif %}
    </div>

</div>

</body>
</html>
